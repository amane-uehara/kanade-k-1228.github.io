% 演算回路
%
%



## 演算回路

### 演算の定義

> 入力空間 $2^N$ から 出力空間 $2^M$ への写像
> $$
> f : 2^N \rightarrow 2^M 
> $$

### 基本演算

> $$
> f_e : 2 \rightarrow 2
> $$

### 構成定理

任意の演算がある基本演算集合の元の合成として構成できる．

### 基本演算集合

基本演算集合として

### 最小基本演算集合



### 回路サイズ

演算 $f$ に必要な基本演算数を評価したい．


### 演算時間

演算 $f$ に必要な時間を評価したい．

一般に演算時間は入力によって変化するので，入力 $a$ に対する演算時間を $T(f,a)$ とする．

入力の確率分布を $P(a)$ としたとき，演算時間の期待値を $T(f,P)=\sum P(a)T(f,a)$ とする．

特に，一様分布に対する演算時間の期待値を $\bar{T}(f)$ とする．

## 群演算器

群 $(2^N,\circ)$ 

### Prefix Sum

入力列 $a_0,a_1\cdots a_{n-1}$ に対して出力列

$$
s_i = a_0 \circ a_1 \circ a_2 \cdots \circ a_i
$$

なる演算器を構成する．

$s_i$ を逐次に求めると $n$ 段必要だが，PrefixSumを使うと $\lceil \log n \rceil$ 段で済ませることができる．

## 加算器

### 並列加算器

$$
(g,p)\circ(g',p') = (g + p \cdot g', p \cdot p')
$$

|         |       |       |         |         |
| ------- | ----- | ----- | ------- | ------- |
| (g',p') | (0,0) | (0,1) | (1,0)   | (1,1)   |
| (g,p)   | (g,0) | (g,p) | (g+p,0) | (g+p,p) |
| (0,0)   | (0,0) | (0,0) | (0,0)   | (0,0)   |
| (0,1)   | (0,0) | (0,1) | (1,0)   | (1,1)   |
| (1,0)   | (1,0) | (1,0) | (1,0)   | (1,0)   |
| (1,1)   | (1,0) | (1,1) | (1,0)   | (1,1)   |


$$
\begin{aligned}
(G,P)_0&=(g,p)_0\\
(G,P)_i&=(g,p)_i\circ(G,P)_{i-1}\\
\end{aligned}
$$

|                  |     | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| ---------------- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| $a$              |     | 1   | 1   | 0   | 1   | 1   | 0   | 1   | 0   |
| $b$              |     | 1   | 0   | 1   | 1   | 1   | 1   | 0   | 0   |
| $g = a \cdot b$  |     | 1   | 0   | 0   | 1   | 1   | 0   | 0   | 0   |
| $p = a \oplus b$ |     | 0   | 1   | 1   | 0   | 0   | 1   | 1   | 0   |
| $G$              |     | 1   | 1   | 1   | 1   | 1   | 0   | 0   | 0   |
| $P$              |     | 0   | 0   | 0   | 0   | 0   | 0   | 0   | 0   |
| $s$              | 1   | 1   | 0   | 0   | 1   | 0   | 1   | 1   | 0   |


